!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("three"),require("gsap/TweenMax")):"function"==typeof define&&define.amd?define(["three","gsap/TweenMax"],t):(e||self).shaderSlider=t(e.THREE,e.TweenMax)}(this,function(e,t){function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,t}var r=/*#__PURE__*/i(e),a=/*#__PURE__*/n(t);return function(e){function t(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}var n=e.parent,i=e.displacementImage,o=e.images;if(o[0]&&o[1]&&i){var f=t(e.imagesRatio,1),s=t(e.intensity1,e.intensity,1),l=t(e.intensity2,e.intensity,0,5),u=t(e.angle,Math.PI/4),d=t(e.angle1,u),v=t(e.angle2,3*-u),c=e.speed,p=!!e.autoplay&&e.autoplay,g=t(e.easing,Expo.easeOut);if(n){var m=new r.Scene,h=new r.OrthographicCamera(n.offsetWidth/-2,n.offsetWidth/2,n.offsetHeight/2,n.offsetHeight/-2,1,1e3);h.position.z=1;var y=new r.WebGLRenderer({antialias:!1,alpha:!0});y.setPixelRatio(2),y.setClearColor(16777215,0),y.setSize(n.offsetWidth,n.offsetHeight),n.appendChild(y.domElement);var x=function(){y.render(m,h)},w=new r.TextureLoader;w.crossOrigin="";var F=w.load(i,x);F.magFilter=F.minFilter=r.LinearFilter;for(var H,M,W=[],P=0;o.length>P;P++)W[P]=w.load(o[P],x),W[P].magFilter=r.LinearFilter,W[P].minFilter=r.LinearFilter;var b=f;n.offsetHeight/n.offsetWidth<b?(H=1,M=n.offsetHeight/n.offsetWidth/b):(H=n.offsetWidth/n.offsetHeight*b,M=1);var I=new r.ShaderMaterial({uniforms:{intensity1:{type:"f",value:s},intensity2:{type:"f",value:l},dispFactor:{type:"f",value:0},angle1:{type:"f",value:d},angle2:{type:"f",value:v},texture1:{type:"t",value:W[0]},texture2:{type:"t",value:W[1]},disp:{type:"t",value:F},res:{type:"vec4",value:new r.Vector4(n.offsetWidth,n.offsetHeight,H,M)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\n\nuniform float dispFactor;\nuniform float dpr;\nuniform sampler2D disp;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform vec2 parent;\n\nmat2 getRotM(float angle) {\n  float s = sin(angle);\n  float c = cos(angle);\n  return mat2(c, -s, s, c);\n}\n\nvoid main() {\n  vec4 disp = texture2D(disp, vUv);\n  vec2 dispVec = vec2(disp.r, disp.g);\n\n  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;\n  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);\n\n\n  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n",transparent:!0,opacity:1}),O=new r.PlaneBufferGeometry(n.offsetWidth,n.offsetHeight,1),V=new r.Mesh(O,I);m.add(V);var _=0;window.addEventListener("resize",function(e){n.offsetHeight/n.offsetWidth<b?(H=1,M=n.offsetHeight/n.offsetWidth/b):(H=n.offsetWidth/n.offsetHeight*b,M=1),V.material.uniforms.res.value=new r.Vector4(n.offsetWidth,n.offsetHeight,H,M),y.setSize(n.offsetWidth,n.offsetHeight),x()}),p&&(autoplayInterval=setInterval(R,5e3)),this.next=function(){autoplayInterval&&clearInterval(autoplayInterval),R()},this.prev=function(){autoplayInterval&&clearInterval(autoplayInterval),function(){-1==(_-=1)&&(_=W.length-1,e=0);var e=Math.round(I.uniforms.dispFactor.value);0==e?(e=1,I.uniforms.texture2.value=W[_]):(e=0,I.uniforms.texture1.value=W[_]),U(e)}()}}else console.warn("Parent missing")}else console.warn("One or more images are missing");function p(){R()}function R(){W.length==(_+=1)&&(_=0,e=0);var e=Math.round(I.uniforms.dispFactor.value);0==e?(e=1,I.uniforms.texture2.value=W[_]):(e=0,I.uniforms.texture1.value=W[_]),U(e)}function U(e){a.default.to(I.uniforms.dispFactor,c,{value:e,ease:g,onUpdate:x,onComplete:x})}}});
//# sourceMappingURL=shader-slider.umd.js.map
